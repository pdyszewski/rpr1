<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>27 Centralne Twierdzenie Graniczne | Rachunek Prawdopodobieństwa 1R</title>
<meta name="author" content="Dariusz Buraczewski">
<meta name="author" content="Piotr Dyszewski">
<meta name="description" content="Dotarliśmy do najważniejszego twierdzenia podczas tego wykładu. Dzięki językowi funkcji charakterystycznych jego dowód jest dosyć prostym wnioskiem z twierdzenia L'evy’ego- Cram'era oraz...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="27 Centralne Twierdzenie Graniczne | Rachunek Prawdopodobieństwa 1R">
<meta property="og:type" content="book">
<meta property="og:description" content="Dotarliśmy do najważniejszego twierdzenia podczas tego wykładu. Dzięki językowi funkcji charakterystycznych jego dowód jest dosyć prostym wnioskiem z twierdzenia L'evy’ego- Cram'era oraz...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="27 Centralne Twierdzenie Graniczne | Rachunek Prawdopodobieństwa 1R">
<meta name="twitter:description" content="Dotarliśmy do najważniejszego twierdzenia podczas tego wykładu. Dzięki językowi funkcji charakterystycznych jego dowód jest dosyć prostym wnioskiem z twierdzenia L'evy’ego- Cram'era oraz...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script><script src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js">
    	</script><script>quizdown.init();</script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="java.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Notatki do wykładu">Rachunek Prawdopodobieństwa 1R</a>:
        <small class="text-muted">Notatki do wykładu</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li><a class="" href="sylabus.html">Sylabus</a></li>
<li class="book-part">Notatki</li>
<li><a class="" href="wprowadzenie.html"><span class="header-section-number">1</span> Wprowadzenie</a></li>
<li><a class="" href="aksjomatyka-rachunku-prawdopodobie%C5%84stwa.html"><span class="header-section-number">2</span> Aksjomatyka rachunku prawdopodobieństwa</a></li>
<li><a class="" href="prawdopodobie%C5%84stwo-warunkowe.html"><span class="header-section-number">3</span> Prawdopodobieństwo warunkowe</a></li>
<li><a class="" href="niezale%C5%BCno%C5%9B%C4%87-zdarze%C5%84.html"><span class="header-section-number">4</span> Niezależność zdarzeń</a></li>
<li><a class="" href="lemat-borela-cantellego.html"><span class="header-section-number">5</span> Lemat Borela-Cantellego</a></li>
<li><a class="" href="zmienne-losowe-i-ich-rozk%C5%82ady.html"><span class="header-section-number">6</span> Zmienne losowe i ich rozkłady</a></li>
<li><a class="" href="warto%C5%9B%C4%87-oczekiwana-definicja-i-w%C5%82asno%C5%9Bci.html"><span class="header-section-number">7</span> Wartość oczekiwana: definicja i własności</a></li>
<li><a class="" href="warto%C5%9B%C4%87-oczekiwana-zastosowania.html"><span class="header-section-number">8</span> Wartość oczekiwana: zastosowania</a></li>
<li><a class="" href="przegl%C4%85d-wa%C5%BCniejszych-rozk%C5%82ad%C3%B3w.html"><span class="header-section-number">9</span> Przegląd ważniejszych rozkładów</a></li>
<li><a class="" href="wektory-losowe.html"><span class="header-section-number">10</span> Wektory losowe</a></li>
<li><a class="" href="rozk%C5%82ady-warunkowe.html"><span class="header-section-number">11</span> Rozkłady warunkowe</a></li>
<li><a class="" href="niezale%C5%BCne-zmienne-losowe.html"><span class="header-section-number">12</span> Niezależne zmienne losowe</a></li>
<li><a class="" href="wariancja.html"><span class="header-section-number">13</span> Wariancja</a></li>
<li><a class="" href="kowariancja.html"><span class="header-section-number">14</span> Kowariancja</a></li>
<li><a class="" href="regresja-liniowa.html"><span class="header-section-number">15</span> Regresja liniowa</a></li>
<li><a class="" href="parametry-wielowymiarowe.html"><span class="header-section-number">16</span> Parametry wielowymiarowe</a></li>
<li><a class="" href="nier%C3%B3wno%C5%9Bci.html"><span class="header-section-number">17</span> Nierówności</a></li>
<li><a class="" href="rodzaje-zbie%C5%BCno%C5%9Bci-zmiennych-losowych.html"><span class="header-section-number">18</span> Rodzaje zbieżności zmiennych losowych</a></li>
<li><a class="" href="prawo-0-1-ko%C5%82mogorowa.html"><span class="header-section-number">19</span> Prawo \(0-1\) Kołmogorowa</a></li>
<li><a class="" href="mocne-prawo-wielkich-liczb.html"><span class="header-section-number">20</span> Mocne prawo wielkich liczb</a></li>
<li><a class="" href="zastosowania-mpwl.html"><span class="header-section-number">21</span> Zastosowania MPWL</a></li>
<li><a class="" href="dygresja-kompresja.html"><span class="header-section-number">22</span> Dygresja: kompresja</a></li>
<li><a class="" href="twierdzenie-de-moivrea-laplacea.html"><span class="header-section-number">23</span> Twierdzenie de Moivre’a-Laplace’a</a></li>
<li><a class="" href="zbie%C5%BCno%C5%9B%C4%87-wed%C5%82ug-rozk%C5%82adu.html"><span class="header-section-number">24</span> Zbieżność według rozkładu</a></li>
<li><a class="" href="funkcje-charakterystyczne.html"><span class="header-section-number">25</span> Funkcje charakterystyczne</a></li>
<li><a class="" href="wielowymiarowe-funkcje-charakterystyczne.html"><span class="header-section-number">26</span> Wielowymiarowe funkcje charakterystyczne</a></li>
<li><a class="active" href="centralne-twierdzenie-graniczne.html"><span class="header-section-number">27</span> Centralne Twierdzenie Graniczne</a></li>
<li><a class="" href="tempo-zbie%C5%BCno%C5%9Bci-w-ctg.html"><span class="header-section-number">28</span> Tempo zbieżności w CTG</a></li>
<li><a class="" href="ctg-lindeberga-fellera.html"><span class="header-section-number">29</span> CTG Lindeberga Fellera</a></li>
<li><a class="" href="zastosowania.html"><span class="header-section-number">30</span> Zastosowania</a></li>
<li class="book-part">Listy zadań</li>
<li><a class="" href="lista-1-rozgrzewka.html">Lista 1: Rozgrzewka</a></li>
<li><a class="" href="lista-2-aksjomaty-rachunku-prawdopodobie%C5%84stwa.html">Lista 2: Aksjomaty rachunku prawdopodobieństwa</a></li>
<li><a class="" href="lista-3-prawdopodobie%C5%84stwo-warunkowe.html">Lista 3: Prawdopodobieństwo warunkowe</a></li>
<li><a class="" href="lista-4-niezale%C5%BCno%C5%9B%C4%87-i-lemat-borela-cantellego.html">Lista 4: Niezależność i lemat Borela-Cantellego</a></li>
<li><a class="" href="lista-5-zmienne-losowe.html">Lista 5: Zmienne losowe</a></li>
<li><a class="" href="lista-6-warto%C5%9B%C4%87-oczekiwana.html">Lista 6: Wartość oczekiwana</a></li>
<li><a class="" href="lista-7-powt%C3%B3rka-przed-kolokwium.html">Lista 7: Powtórka przed kolokwium</a></li>
<li><a class="" href="lista-8-wektory-losowe.html">Lista 8: wektory losowe</a></li>
<li><a class="" href="lista-9-niezale%C5%BCne-zmienne.html">Lista 9: Niezależne zmienne</a></li>
<li><a class="" href="lista-10-wariancja.html">Lista 10: Wariancja</a></li>
<li><a class="" href="lista-11-momenty-wielowymiarowe-i-nier%C3%B3wno%C5%9Bci.html">Lista 11: Momenty wielowymiarowe i nierówności</a></li>
<li><a class="" href="lista-12-zbie%C5%BCno%C5%9B%C4%87.html">Lista 12: Zbieżność</a></li>
<li><a class="" href="lista-13-s%C5%82aba-zbie%C5%BCno%C5%9B%C4%87.html">Lista 13: Słaba zbieżność</a></li>
<li><a class="" href="lista-14-powt%C3%B3rka-przed-kolokwium.html">Lista 14: Powtórka przed kolokwium</a></li>
<li><a class="" href="lista-15-funkcje-charakterystyczne-i-centralne-twierdzenie-graniczne.html">Lista 15: Funkcje charakterystyczne i centralne twierdzenie graniczne</a></li>
<li class="book-part">Dodatek</li>
<li><a class="" href="twierdzenie-fubiniego.html">Twierdzenie Fubiniego</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="centralne-twierdzenie-graniczne" class="section level1" number="27">
<h1>
<span class="header-section-number">27</span> Centralne Twierdzenie Graniczne<a class="anchor" aria-label="anchor" href="#centralne-twierdzenie-graniczne"><i class="fas fa-link"></i></a>
</h1>
<p>Dotarliśmy do najważniejszego twierdzenia podczas tego wykładu.
Dzięki językowi funkcji charakterystycznych jego dowód jest dosyć prostym wnioskiem z
twierdzenia L'evy’ego- Cram'era oraz twierdzenia Taylora (z analizy 1).
Warto zwrócić uwagę na dużą ogólność tego wyniku,
zależy on nie od rozkładu zmiennych losowych,
a jedynie od parametrów liczbowych: <span class="math inline">\(\mathbb{E}[X]\)</span> i <span class="math inline">\(\mathbb{V}ar [X]\)</span>.</p>
<p>Zaczniemy od pomocniczego twierdzenia.</p>
<div class="theorem">
<p><span id="thm:t342" class="theorem"><strong>Twierdzenie 27.1  </strong></span>Jeśli <span class="math inline">\(c_n \to c \in \mathbb{C}\)</span>,
to <span class="math inline">\((1 + c_n/n)^n \to e^c\)</span>.</p>
</div>
<p>Dowód Twierdzenia <a href="centralne-twierdzenie-graniczne.html#thm:t342">27.1</a> będzie się opierał na dwóch pomocniczych lematach.</p>
<div class="lemma">
<p><span id="lem:l343" class="lemma"><strong>Lemma 27.1  </strong></span>Niech <span class="math inline">\(z_1, \ldots, z_n\)</span> oraz <span class="math inline">\(w_1, \ldots, w_n\)</span> będą liczbami zespolonymi
o module <span class="math inline">\(\leq \theta\)</span>. Wtedy
<span class="math display">\[
\left| \prod_{m=1}^{n} z_m - \prod_{m=1}^{n} w_m \right|
\leq \theta^{n-1} \sum_{m=1}^{n} |z_m - w_m|
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-306" class="proof"><em>Proof</em>. </span>Dla <span class="math inline">\(n = 1\)</span> teza jest oczywista.
Aby dowieść dla <span class="math inline">\(n &gt; 1\)</span>, zauważmy że
<span class="math display">\[\begin{align*}
&amp; \left| \prod_{m=1}^{n} z_m - \prod_{m=1}^{n} w_m \right| =\\
&amp; \left| z_1 \prod_{m=2}^{n} z_m - z_1 \prod_{m=2}^{n} w_m + z_1 \prod_{m=2}^{n} w_m - w_1 \prod_{m=2}^{n} w_m \right| \\
&amp; \leq \theta \left| \prod_{m=2}^{n} z_m - \prod_{m=2}^{n} w_m \right| + \theta^{n-1} |z_1 - w_1|.
\end{align*}\]</span>
Następnie korzystamy z indukcji.</p>
<p><span style="display: inline-block; width: 100%; text-align: right;">□</span></p>
</div>
<div class="lemma">
<p><span id="lem:l344" class="lemma"><strong>Lemma 27.2  </strong></span>Jeśli <span class="math inline">\(b\)</span> jest liczbą zespoloną i <span class="math inline">\(|b| \leq 1\)</span>, to
<span class="math display">\[
\left|e^b - (1 + b)\right| \leq |b|^2.
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-307" class="proof"><em>Proof</em>. </span>Mamy
<span class="math display">\[
e^b - (1 + b) = b^2/2! + b^3/3! + b^4/4! + \ldots,
\]</span>
więc jeśli <span class="math inline">\(|b| \leq 1\)</span>, to
<span class="math display">\[\begin{align*}
\left|e^b - (1 + b)\right| &amp;
\leq \frac{|b|^2}{2} \left(1 + \frac{1}{2} + \frac{1}{2^2} + \ldots \right)\\
&amp; = |b|^2.
\end{align*}\]</span></p>
<p><span style="display: inline-block; width: 100%; text-align: right;">□</span></p>
</div>
Powyższą nierówność możemy zwizualizować na wykresie
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script><div id="plot" style="width: 100%; height: 600px;">

</div>
<script>
    const N = 100;
    const xRange = Array.from({ length: N }, (_, i) => -1 + 2 * i / (N - 1));
    const yRange = Array.from({ length: N }, (_, i) => -1 + 2 * i / (N - 1));

    const z1 = []; // |e^b - 1 - b|
    const z2 = []; // |b|^2

    for (let i = 0; i < N; i++) {
      const row1 = [];
      const row2 = [];
      const x = xRange[i];
      for (let j = 0; j < N; j++) {
        const y = yRange[j];
        const r2 = x * x + y * y;

        if (r2 < 1) {
          const reExp = Math.exp(x) * Math.cos(y);
          const imExp = Math.exp(x) * Math.sin(y);

          const reDiff = reExp - 1 - x;
          const imDiff = imExp - y;
          const f1 = Math.sqrt(reDiff ** 2 + imDiff ** 2); // |e^b - 1 - b|
          const f2 = r2; // |b|^2

          row1.push(f1);
          row2.push(f2);
        } else {
          row1.push(NaN); // poza dyskiem – brak punktu
          row2.push(NaN);
        }
      }
      z1.push(row1);
      z2.push(row2);
    }

    const surface1 = {
      z: z1,
      x: xRange,
      y: yRange,
      type: 'surface',
      surfacecolor: z1,
      colorscale: [[0, 'rgb(42,161,152)'], [1, 'rgb(42,161,152)']],
      name: '|e^b - 1 - b|',
      showscale: false,
      opacity: 0.9
    };

    const surface2 = {
      z: z2,
      x: xRange,
      y: yRange,
      type: 'surface',
      surfacecolor: z2,
      colorscale: [[0, 'rgb(238,232,213)'], [1, 'rgb(238,232,213)']],
      name: '|b|²',
      showscale: false,
      opacity: 0.6
    };

    const layout = {
     margin: {
        l: 10,  // np. mniejsze marginesy
        r: 10,
        t: 10,
        b: 10
     },
paper_bgcolor: 'rgb(0,43,54)',
      plot_bgcolor: 'rgb(0,43,54)',
      font: { color: 'white' },
      scene: {
        xaxis: { title: 'Re(b)', backgroundcolor: 'rgb(0,43,54)', gridcolor: 'gray' },
        yaxis: { title: 'Im(b)', backgroundcolor: 'rgb(0,43,54)', gridcolor: 'gray' },
        zaxis: { title: 'Wartość', backgroundcolor: 'rgb(0,43,54)', gridcolor: 'gray' }
      }
    };

    Plotly.newPlot('plot', [surface1, surface2], layout);
  </script><div class="proof">
<p><span id="unlabeled-div-308" class="proof"><em>Proof</em> (Twierdzenia <a href="centralne-twierdzenie-graniczne.html#thm:t342">27.1</a>). </span>Niech <span class="math inline">\(z_m = (1 + c_n/n)\)</span>, <span class="math inline">\(w_m = \exp(c_n/n)\)</span> oraz
<span class="math inline">\(\gamma &gt; |c|\)</span>.
Dla dużych <span class="math inline">\(n\)</span>, <span class="math inline">\(|c_n| &lt; \gamma\)</span>.
Ponieważ <span class="math inline">\(1 + \gamma/n \leq \exp(\gamma/n)\)</span>,
to na podstawie Lematów <a href="centralne-twierdzenie-graniczne.html#lem:l343">27.1</a> oraz <a href="centralne-twierdzenie-graniczne.html#lem:l344">27.2</a> otrzymujemy
<span class="math display">\[\begin{align*}
\left| (1 + c_n/n)^n - e^{c_n} \right| &amp;
\leq (e^{\gamma/n})^{n-1} \cdot n \left| \frac{c_n}{n} \right|^2 \\
&amp; \leq e^{\gamma} \cdot \frac{\gamma^2}{n} \to 0
\end{align*}\]</span>
gdy <span class="math inline">\(n \to \infty\)</span>.</p>
<p><span style="display: inline-block; width: 100%; text-align: right;">□</span></p>
</div>
<p>Przedstawimy najpierw najprostszą wersję CTG:</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-309" class="theorem"><strong>Twierdzenie 27.2  (Centralne Twierdzenie Graniczne) </strong></span>Niech <span class="math inline">\(\{X_n\}_{n\in\mathbb{N}}\)</span> będzie ciągiem niezależnych zmiennych
losowych o takim samym rozkładzie i takim, że <span class="math inline">\(\mathbb{E}[ X_1] = m\)</span>,
<span class="math inline">\(\mathbb{V}ar [X_1] = \sigma^2&gt;0\)</span>. Wówczas
<span class="math display">\[
  \frac{X_1+\ldots+X_n - nm}{\sqrt n \sigma} \Rightarrow \mathcal{N}(0,1).
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-310" class="proof"><em>Proof</em>. </span>Dla uproszczenia notacji połóżmy <span class="math inline">\(Y_i = X_i -m\)</span>.
Wtedy <span class="math inline">\(\mathbb{E}[ Y_i]=0\)</span>, <span class="math inline">\(\mathbb{V}ar[Y] = \sigma^2\)</span>.
Zmienna losowa <span class="math inline">\(Y=Y_1\)</span> ma pierwszy i drugi moment zatem funkcja <span class="math inline">\(\varphi_Y\)</span>
jest dwukrotnie różniczkowalna w zerze (przypomnijmy
<span class="math inline">\(\varphi_X^{(k)}(0) = i^k\mathbb{E}\left[X^k\right]\)</span>):
<span class="math display">\[\begin{align*}
    \varphi_Y(0) &amp; =1,\\
    \varphi'_Y(0) &amp; =0,\\
    \varphi''_Y(0) &amp; =-\mathbb{E}\left[ Y^2\right] = -\mathbb{V}ar [Y] = -\sigma^2.
  \end{align*}\]</span>
Zatem z twierdzenia <a href="funkcje-charakterystyczne.html#thm:t107">25.3</a>
<span class="math display">\[\begin{align*}
  \phi_Y(t) &amp; = \phi_Y(0) + \phi'_Y(0)\cdot t + \phi''_Y(0)\cdot \frac{t^2}{2} + h(t) \\
  &amp; = 1 - \frac{t^2\sigma^2}{2} + h(t),
  \end{align*}\]</span>
gdzie <span class="math inline">\({h(t)}/{t^2}\to 0\)</span>, gdy <span class="math inline">\(t\to 0\)</span>. Funkcja <span class="math inline">\(h\)</span> powyżej może być zespolona.
Ustalmy <span class="math inline">\(t\)</span>. Mamy
<span class="math display">\[\begin{align*}
    \phi_{\frac{X_1+\ldots+ X_n - nm}{\sqrt n \sigma}} (t) =&amp;
    \phi_{\frac{Y_1+\ldots+ Y_n }{\sqrt n \sigma}} (t) \\
    = &amp; \left(\phi_{\frac Y{\sqrt n \sigma}}(t)\right)^n \\
     =&amp; \phi_Y \left(\frac{t}{\sqrt n \sigma}\right) ^n\\
    =&amp; \left( 1 - \frac{\sigma^2}{2} \cdot \left(\frac{t}{\sqrt n\sigma}\right)^2\right. \\
    &amp; \left.+ h\left(\frac{t}{\sqrt n \sigma}\right)\right)^n\\
    =&amp;  \left( 1 - \frac{t^2}{2n} + h\left(\frac{t}{\sqrt n \sigma}\right)\right)^n
  \end{align*}\]</span>
Weźmy
<span class="math display">\[
  c_n = n\left(-\frac{t^2}{2n} + h\left(\frac{t}{\sqrt n \sigma}\right)\right).
  \]</span>
Wówczas <span class="math inline">\(c_n \to -t^2/2\)</span>, a więc z Twierdzenia <a href="centralne-twierdzenie-graniczne.html#thm:t342">27.1</a>
<span class="math display">\[
    \phi_{\frac{X_1+\ldots+ X_n - nm}{\sqrt n \sigma}} (t) \overset{n\to\infty}{\to} e^{-\frac{t^2}2}.
  \]</span>
Funkcja <span class="math inline">\(e^{-\frac{t^2}2}\)</span> jest funkcją charakterystyczną zmiennej losowej o
rozkładzie <span class="math inline">\(\mathcal{N}(0,1)\)</span> (z twierdzenia o jednoznaczności wiemy,
że to jest jedyny rozkład posiadający taką funkcję charakterystyczną).
Z twierdzenia Lévy’ego-Craméra wnioskujemy tezę.</p>
</div>
<iframe width="100%" height="315" src="https://www.youtube.com/embed/zeJD6dqJ5lo?si=6AuIafQhI89Lv7M5" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<div class="example">
<p><span id="exm:unlabeled-div-311" class="example"><strong>Przykład 27.1  </strong></span>Koło ruletki ma pola ponumerowane od <span class="math inline">\(1\)</span> do <span class="math inline">\(36\)</span> (<span class="math inline">\(18\)</span> czerwonych i <span class="math inline">\(18\)</span> czarnych)
oraz dwa pola ponumerowane <span class="math inline">\(0\)</span> i <span class="math inline">\(00\)</span>, które są zielone.
Gracze mogą postawić <span class="math inline">\(\$1\)</span> na to, że kulka wyląduje na czerwonym (lub czarnym) polu i wygrać <span class="math inline">\(\$1\)</span>,
jeśli tak się stanie. Jeśli oznaczymy <span class="math inline">\(X_i\)</span> jako wygraną w <span class="math inline">\(i\)</span>-tej grze,
to <span class="math inline">\(X_1, X_2, \ldots\)</span> są niezależne i identycznie rozłożone z
<span class="math display">\[\begin{align*}
\mathbb{P}[X_i = 1] &amp; = 18/38 \\
\mathbb{P}[X_i = -1] &amp; = 20/38.
\end{align*}\]</span>
Stąd
<span class="math display">\[\begin{align*}
\mathbb{E}[X_i] &amp; = 1 \cdot \frac{18}{38} + (-1) \cdot \frac{20}{38}  \\
&amp; = -1/19
\end{align*}\]</span>
oraz
<span class="math display">\[\begin{align*}
\mathbb{V}ar(X_i) &amp; = \mathbb{E}\left[X^2\right] - (\mathbb{E}[X])^2  \\
&amp; = 1 - (1/19)^2 \approx 0.9972
\end{align*}\]</span>
Interesuje nas
<span class="math display">\[\begin{equation*}
\mathbb{P}(S_n \geq 0)  =
\mathbb{P}\left( \frac{S_n - n\mu}{\sigma \sqrt{n}} \geq \frac{-n\mu}{\sigma \sqrt{n}} \right)
\end{equation*}\]</span>
Bierzemy <span class="math inline">\(n = 361 = 19^2\)</span> i dla uproszczenia obliczeń przyjmujemy <span class="math inline">\(\sigma \approx 1\)</span>:
<span class="math display">\[
\frac{-n\mu}{\sigma \sqrt{n}} = \frac{361 \cdot (-1/19)}{\sqrt{361}} = -19/1 = -1
\]</span>
Zatem centralne twierdzenie graniczne mówi nam, że:
<span class="math display">\[
\mathbb{P}[S_n \geq 0] \approx \mathbb{P}(Z \geq 1) = 1 - 0.8413 = 0.1587
\]</span>
Innymi słowy, po <span class="math inline">\(361\)</span> grach w ruletkę kasyno przeciętnie zabierze nam <span class="math inline">\(\$19\)</span>, ale za to
istnieje około <span class="math inline">\(16\%\)</span> szansy, że będziemy na plusie.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-312" class="example"><strong>Przykład 27.2  </strong></span>Na podstawie losowej próby szacujemy procent dorosłych,
którzy potrafią czytać i pisać. Wiadomo, że jest to powyżej <span class="math inline">\(90\%\)</span> dorosłej populacji.
Chcemy, aby błąd był mniejszy niż <span class="math inline">\(0,01\)</span> z prawdopodobieństwem <span class="math inline">\(0,9\)</span>. Ile osób musi liczyć próba?</p>
<p>Niech <span class="math inline">\(p\)</span> oznacza prawdopodobieństwo, że losowo wybrana osoba umie czytać i pisać.
Oznaczmy przez <span class="math inline">\(n\)</span> liczbę osób testowanych.
Parametry <span class="math inline">\(n\)</span> i <span class="math inline">\(p\)</span> są nieznane.
Chcemy najpierw oszacować <span class="math inline">\(n\)</span>, a potem <span class="math inline">\(p\)</span>.
Niech
<span class="math display">\[
X_i = \left\{\begin{array}{cc}
               1 &amp;\  \mbox{$i$-ta osoba potrafi czytać i pisać} \\
               0 &amp;\  \mbox{w przeciwnym razie.}
             \end{array}
\right.
\]</span>
Oznaczmy przez <span class="math inline">\(S_n = X_1+\ldots + X_n\)</span> liczbę osób, które z próbki <span class="math inline">\(n\)</span>-osobowej,
które potrafią czytać. Chcemy przyjąć <span class="math inline">\(p\approx \frac {S_n}n\)</span>. Badamy teraz dla jakich <span class="math inline">\(n\)</span>
prawdopodobieństwo błędu będzie małe, czyli
<span class="math display">\[
\mathbb{P}\left[ \left|\frac{S_n}n-p\right|\le 0,01\right] \ge 0,9.
\]</span>
<span class="math inline">\(S_n\)</span> ma rozkład dwumianowy z parametrami <span class="math inline">\(n\)</span> i <span class="math inline">\(p\)</span>.
Przypomnijmy <span class="math inline">\(\mathbb{E}[ X_1] = p\)</span>, <span class="math inline">\(\mathbb{V}ar [X_1] = p(1-p)\)</span>.
Wówczas skorzystamy z Centralnego Twierdzenia Granicznego
(w tym miejscu wystarczy odwołać się do twierdzenia de Moivre’a - Laplace’a).
Zapiszmy powyższą nierówność w postaci
<span class="math display">\[
\mathbb{P}\left[ \left|\frac{S_n-np}{\sqrt{np(1-p)}}\right|\le \frac{\sqrt n}{100 \sqrt{p(1-p)}}\right] \ge 0,9.
\]</span>
Z CTG zmienną losową <span class="math inline">\((S_n-np)/(\sqrt{np(1-p)})\)</span> możemy przybliżyć rozkładem normalnym.
Oznaczmy <span class="math inline">\(x_0 = \frac{\sqrt n}{100 \sqrt{p(1-p)}}\)</span>. Szukamy takiej wartości <span class="math inline">\(p\)</span>, aby
<span class="math display">\[\begin{align*}
0,9 &amp; \le \Phi(x_0) - \Phi(-x_0) \\
&amp;= \Phi(x_0) - (1-\Phi(x_0)) \\ &amp; = 2\Phi(x_0)-1,
\end{align*}\]</span>
gdzie <span class="math inline">\(\Phi\)</span> jest dystrybuantą rozkładu normalnego. Stąd
<span class="math display">\[
\Phi(x_0)\ge 0,95.
\]</span> Z tablic możemy odczytać, że <span class="math inline">\(x_0\ge 1,64\)</span>. To implikuje
<span class="math display" id="eq:nnd">\[\begin{equation}
\sqrt n \ge 1,64\cdot 100 \cdot \sqrt{p(1-p)}
\tag{27.1}
\end{equation}\]</span>
Niestety nie znamy dokładnej wartości <span class="math inline">\(p\)</span>, wiemy jedynie, że <span class="math inline">\(p&gt;0,9\)</span>. Zauważmy, że funkcja <span class="math inline">\(p\mapsto p(1-p)\)</span> dla <span class="math inline">\(p\in [0,9;1]\)</span> jest malejąca (jest to fragment paraboli). Zatem jeżeli
<span class="math display">\[\sqrt n  \ge 164\cdot \sqrt{0,9\cdot 0,1} \approx 49,
\]</span> to nierówność <a href="centralne-twierdzenie-graniczne.html#eq:nnd">(27.1)</a> jest spełniona dla każdego <span class="math inline">\(p\ge 0,9\)</span>.
Ostatecznie dla
<span class="math display">\[
n&gt; 2401
\]</span> możemy przybliżyć <span class="math inline">\(p\)</span> wartością <span class="math inline">\(S_n/n\)</span> i mamy zagwarantowane, że
żądane warunki są spełnione.</p>
</div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="wielowymiarowe-funkcje-charakterystyczne.html"><span class="header-section-number">26</span> Wielowymiarowe funkcje charakterystyczne</a></div>
<div class="next"><a href="tempo-zbie%C5%BCno%C5%9Bci-w-ctg.html"><span class="header-section-number">28</span> Tempo zbieżności w CTG</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#centralne-twierdzenie-graniczne"><span class="header-section-number">27</span> Centralne Twierdzenie Graniczne</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Rachunek Prawdopodobieństwa 1R</strong>: Notatki do wykładu" was written by Dariusz Buraczewski, Piotr Dyszewski. It was last built on 2025-06-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
